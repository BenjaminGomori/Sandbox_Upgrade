<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>

    <!-- from:
        https://www.codeply.com/p/J7fUOhLOy9
        https://www.codeply.com/p/WGCqYEiPBg -->

    <meta charset="UTF-8">
    <title>New Design</title>
    <!--        <link rel="shortcut icon" href="#">-->
    <!--        <script type="text/javascript" th:inline="javascript" th:src="@{/js/bootstrap.bundle.min.js}"></script>-->
    <script type="text/javascript" th:inline="javascript" th:src="@{/js/popper.min.js}"></script>
    <!--        <script type="text/javascript" th:inline="javascript" th:src="@{/js/bootsrap.min.js}"></script>-->
    <script type="text/javascript" th:inline="javascript" th:src="@{/js/jquery-3.4.1.min.js}"></script>
    <script type="text/javascript" th:inline="javascript" th:src="@{/js/jquery-ui.min.js}"></script>
    <script type="text/javascript" th:inline="javascript" th:src="@{/js/split-grid.js}"></script>
    <script type="text/javascript" th:inline="javascript" th:src="@{/js/wmks.min.js}"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
            integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
            integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
            crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>



    <link rel="stylesheet" th:href="@{/css/jquery-ui.css}" type="text/css">
    <!--        <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}" type="text/css">-->

    <link rel="stylesheet" th:href="@{/css/login/all.min.css}" type="text/css">
    <link rel="stylesheet" th:href="@{/css/login/bootstrap.min.css}" type="text/css">
    <link rel="stylesheet" th:href="@{/css/login/bootstrap.bundle.min.js.css}" type="text/css">
    <link rel="stylesheet" th:href="@{/css/wmks-all.css}" type="text/css">
    <link rel="stylesheet" th:href="@{/css/split.css}" type="text/css">
    <link rel="stylesheet" th:href="@{/css/capstone.css}" type="text/css">
</head>

<body style="color:#d1c6c6;">
<!--<body>-->
<div class="offcanvas offcanvas-start w-25" tabindex="-1" id="offcanvas" data-bs-keyboard="false" data-bs-backdrop="false" style="background-color: rgb(248 247 247);color:#212529;">
    <!--    <div class="offcanvas-header" style="background-color: #222324 ">#FF0000-->
<!--    <div class="offcanvas-header" style="background:linear-gradient(to right, #000, #cf342b)">-->
    <div class="offcanvas-header" style="background:linear-gradient(to right, #000, #cf342b)">

        <!--    <div style="display:flex; align-items: center; background-color: #4b4c4d;">-->
        <div style="display:flex; position: relative;top: 0.7rem;">
            <img th:src="@{/images/logo_only.png}" style="width: 55px;height: 55px; " alt="">
            <p style="color:#ffffff; width: 131px;height: 57px;" alt="">OHIO CYBER RANGE INSTITUTE<p>
        </div>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close" style="border-radius: 5px; background-color:#d7d7d7 !important; opacity:0.88 !important;"></button>
    </div>
    <div class="offcanvas-body px-0">
        <ul class="nav nav-pills flex-column mb-sm-auto mb-0 align-items-start" id="menu" style="font-size: 1.2rem;padding-left: 1rem;">
            <li class="dropdown">
                <h4>Selections</h4>
                <hr style="background-color: rgb(15 14 14);">
            </li>
            <li class="nav-item">
                <a href="#" class=" nav-link dropdown-toggle  text-truncate" id="dropdown-courses" data-bs-toggle="dropdown" aria-expanded="false">
                    <!--                    <a href="#submenu1" data-bs-toggle="collapse" class="nav-link px-0 align-middle">-->
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="black" class="bi bi-book" viewBox="0 0 16 16">
                        <path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"/>
                    </svg>
                    <i class="bi bi-book"></i><span style="color:black;" class="ms-1 d-none d-sm-inline">Courses</span>
                </a>
                <ul class="dropdown-menu text-small shadow courses-menu" aria-labelledby="dropdown-courses" >
                    <!--                    <ul class="collapse show nav flex-column ms-1" id="submenu1" data-bs-parent="#menu">-->
                    <li th:each="course : ${listCourse}"><a class="dropdown-item course-link" href="#" th:classappend="${course.id}" th:text="${course.number} + ' - ' + ${course.name}"></a></li>
                </ul>
            </li>
            <li class="dropdown" style="margin-left: 1rem;">
                <a href="#" class="nav-link dropdown-toggle  text-truncate" id="dropdown-vms" data-bs-toggle="dropdown" aria-expanded="false">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="black" class="bi bi-display" viewBox="0 0 16 16">
                        <path d="M0 4s0-2 2-2h12s2 0 2 2v6s0 2-2 2h-4c0 .667.083 1.167.25 1.5H11a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1h.75c.167-.333.25-.833.25-1.5H2s-2 0-2-2V4zm1.398-.855a.758.758 0 0 0-.254.302A1.46 1.46 0 0 0 1 4.01V10c0 .325.078.502.145.602.07.105.17.188.302.254a1.464 1.464 0 0 0 .538.143L2.01 11H14c.325 0 .502-.078.602-.145a.758.758 0 0 0 .254-.302 1.464 1.464 0 0 0 .143-.538L15 9.99V4c0-.325-.078-.502-.145-.602a.757.757 0 0 0-.302-.254A1.46 1.46 0 0 0 13.99 3H2c-.325 0-.502.078-.602.145z"/>
                    </svg>
                    <i class="bi bi-display"></i><span style="color:black;" class="ms-1 d-none d-sm-inline">VMs</span>
                </a>
                <ul class="dropdown-menu text-small shadow vm-instructor-menu" aria-labelledby="dropdown-vms">
                    <li  th:each="vm : ${listCourse[0].publicVms}"
<!--                         th:object="${vm}"-->
<!--                         th:if="${vm.instructorId} == ${user.id}">-->
                        <a class="dropdown-item" href="#" th:classappend="${vm.vmID}" th:text="${vm.name}"></a>
                    </li>

                </ul>
            </li>

            <li class="dropdown students-vms-menu-section" style="margin-left: 1rem;">
                <a href="#" class="nav-link dropdown-toggle  text-truncate" id="dropdown-stu-vms" data-bs-toggle="dropdown" aria-expanded="false">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="black" class="bi bi-display" viewBox="0 0 16 16">
                        <path d="M0 4s0-2 2-2h12s2 0 2 2v6s0 2-2 2h-4c0 .667.083 1.167.25 1.5H11a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1h.75c.167-.333.25-.833.25-1.5H2s-2 0-2-2V4zm1.398-.855a.758.758 0 0 0-.254.302A1.46 1.46 0 0 0 1 4.01V10c0 .325.078.502.145.602.07.105.17.188.302.254a1.464 1.464 0 0 0 .538.143L2.01 11H14c.325 0 .502-.078.602-.145a.758.758 0 0 0 .254-.302 1.464 1.464 0 0 0 .143-.538L15 9.99V4c0-.325-.078-.502-.145-.602a.757.757 0 0 0-.302-.254A1.46 1.46 0 0 0 13.99 3H2c-.325 0-.502.078-.602.145z"/>
                    </svg>
                    <i class="bi bi-display"></i><span style="color:black;" class="ms-1 d-none d-sm-inline">Students VMs</span>
                </a>

                <ul class="all-students-vms-menu dropdown-menu text-small shadow" aria-labelledby="dropdown-stu-vms" style="padding:0.5rem;">
                    <li th:each="studentVmsMap : ${listCourse[0].publicStudentVmsMap}">
                        <div style="pointer-events: none;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="black" class="bi bi-person-circle" viewBox="0 0 16 16">
                                <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                                <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
                            </svg>
                            <i class="bi bi-person-circle"></i>
                            <span style="color:black;" class="ms-1 d-none d-sm-inline" th:text="${studentVmsMap.key.username}"}></span>
                        </div>
                        <!--                        <ul class="dropdown-menu text-small shadow vm-students-menu" aria-labelledby="dropdown">-->
                        <ul class="a-student-vms-menu" style="list-style-type: none;">
                            <li  th:each="vm : ${studentVmsMap.value}">
                                <a  class="dropdown-item" href="#" th:classappend="${vm.vmID}" th:text="${vm.name}"></a>
                            </li>
                        </ul>
                    </li>



                </ul>
            </li>
            <li class="dropdown labs-menu-section no_display" style="margin-left: 1rem;">
                <a href="#" class="nav-link dropdown-toggle  text-truncate" id="dropdown-labs" data-bs-toggle="dropdown" aria-expanded="false">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="black" class="bi bi-easel2" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M8 0a.5.5 0 0 1 .447.276L8.81 1h4.69A1.5 1.5 0 0 1 15 2.5V11h.5a.5.5 0 0 1 0 1h-2.86l.845 3.379a.5.5 0 0 1-.97.242L12.11 14H3.89l-.405 1.621a.5.5 0 0 1-.97-.242L3.36 12H.5a.5.5 0 0 1 0-1H1V2.5A1.5 1.5 0 0 1 2.5 1h4.691l.362-.724A.5.5 0 0 1 8 0ZM2 11h12V2.5a.5.5 0 0 0-.5-.5h-11a.5.5 0 0 0-.5.5V11Zm9.61 1H4.39l-.25 1h7.72l-.25-1Z"/>
                    </svg>
                    <i class="bi bi-easel2"></i><span style="color:black;" class="ms-1 d-none d-sm-inline">Labs</span> </a>
                <ul class="dropdown-menu text-small shadow labs-menu" aria-labelledby="dropdown-labs">
                    <li  th:each="lab : ${listCourse[0].publicLabs}"><a class="dropdown-item" href="#" th:classappend="${lab.id}" th:text="${lab.number} + ' - ' + ${lab.title}"></a></li>
                </ul>
            </li>


            <li>
                <a href="#" class="nav-link text-truncate">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="black" class="bi bi-calendar" viewBox="0 0 16 16">
                        <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                    </svg>
                    <i class="bi bi-calendar"></i><span style="color:black;" class="ms-1 d-none d-sm-inline">Calendar</span></a>
            </li>

            <li class="dropdown" style="margin-top: 2rem">
                <h4>Other Pages</h4>
                <hr style="background-color: rgb(15 14 14);">
                <a class="dropdown-item hover-underline" href="/create-lab" >Create Lab</a>
            </li>

            <!--                <li>-->
            <!--                    <a href="#submenu1" data-bs-toggle="collapse" class="nav-link px-0 align-middle">-->
            <!--                        <i class="fs-4 bi-speedometer2"></i> <span class="ms-1 d-none d-sm-inline">Dashboard</span> </a>-->
            <!--                    <ul class="collapse show nav flex-column ms-1" id="submenu1" data-bs-parent="#menu">-->
            <!--                        <li class="w-100">-->
            <!--                            <a href="#" class="nav-link px-0"> <span class="d-none d-sm-inline">Item</span> 1 </a>-->
            <!--                        </li>-->
            <!--                        <li>-->
            <!--                            <a href="#" class="nav-link px-0"> <span class="d-none d-sm-inline">Item</span> 2 </a>-->
            <!--                        </li>-->
            <!--                    </ul>-->
            <!--                </li>-->

            <li class="dropdown" style="position:absolute; bottom: 2rem;">
                <a href="#" class="nav-link dropdown-toggle  text-truncate" id="dropdown" data-bs-toggle="dropdown" aria-expanded="false">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="black" class="bi bi-person-circle" viewBox="0 0 16 16">
                        <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                        <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
                    </svg>
                    <i class="bi bi-person-circle"></i><span style="color:black;" class="ms-1 d-none d-sm-inline">User</span>
                </a>
                <ul class="dropdown-menu dropdown-menu-end text-small shadow" aria-labelledby="dropdown">
                    <li><a class="dropdown-item disabled" href="#" th:text="${user.email}"></a></li>
                    <li>
                        <hr class="dropdown-divider">
                    </li>
                    <li><a class="dropdown-item" href="/logout">Sign out</a></li>
                </ul>
            </li>
        </ul>
<!--        <div th:replace="~{fragments/footerUI :: footer}"></div>-->

    </div>
</div>
<!-- template to use for generating svg for student vms menu-->
<template id="userIconForStudentVmsMenu">
    <div style="pointer-events: none;">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="black" class="bi bi-person-circle" viewBox="0 0 16 16">
            <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
            <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
        </svg>
        <i class="bi bi-person-circle"></i>
        <span style="color:black;" class="ms-1 d-none d-sm-inline"></span>
    </div>
</template>
<!--    <div class="container-fluid">-->
<!--        <div class="row">-->
<!--            <div class="col min-vh-100 p-4">-->
<!--                &lt;!&ndash; toggler &ndash;&gt;-->
<!--                <button class="btn float-end" data-bs-toggle="offcanvas" data-bs-target="#offcanvas" role="button">-->
<!--                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right-square-fill" viewBox="0 0 16 16">-->
<!--                        <path d="M0 14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v12zm4.5-6.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5a.5.5 0 0 1 0-1z"/>-->
<!--                    </svg>-->
<!--                    <i class="bi bi-arrow-right-square-fill fs-3" data-bs-toggle="offcanvas" data-bs-target="#offcanvas"></i>-->
<!--                </button>-->
<!--                <h3>Sample Content...</h3>-->
<!--                <p>Sriracha biodiesel taxidermy organic post-ironic, Intelligentsia salvia mustache 90's code editing brunch. Butcher polaroid VHS art party, hashtag Brooklyn deep v PBR narwhal sustainable mixtape swag wolf squid tote bag. Tote bag cronut semiotics, raw denim deep v taxidermy messenger bag. Tofu YOLO Etsy, direct trade ethical Odd Future jean shorts paleo. Forage Shoreditch tousled aesthetic irony, street art organic Bushwick artisan cliche semiotics ugh synth chillwave meditation. Shabby chic lomo plaid vinyl chambray Vice. Vice sustainable cardigan, Williamsburg master cleanse hella DIY 90's blog.</p>-->
<!--                <p>Ethical Kickstarter PBR asymmetrical lo-fi. Dreamcatcher street art Carles, stumptown gluten-free Kickstarter artisan Wes Anderson wolf pug. Godard sustainable you probably haven't heard of them, vegan farm-to-table Williamsburg slow-carb readymade disrupt deep v. Meggings seitan Wes Anderson semiotics, cliche American Apparel whatever. Helvetica cray plaid, vegan brunch Banksy leggings +1 direct trade. Wayfarers codeply PBR selfies. Banh mi McSweeney's Shoreditch selfies, forage fingerstache food truck occupy YOLO Pitchfork fixie iPhone fanny pack art party Portland.</p> Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia cor magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur?-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--<div class="sticky-top" th:switch="${user.type}" style="position: absolute; width:100vw;">-->
<!--    <div th:case="'student'">-->
<!--        <nav th:replace="~{fragments/studentTopNav :: navbar}"></nav>-->
<!--    </div>-->
<!--    <div th:case="'instructor'">-->
<!--        <nav th:replace="~{fragments/instructorTopNav :: navbar}"></nav>-->
<!--    </div>-->
<!--</div>-->

<!-- Section: Split screen -->
<!-- from https://mdbootstrap.com/learn/mdb-foundations/mdb-ui-kit/split-screen/-->
<section class="">
<!--    <div class="container-fluid px-0" style="background-color: #3d5267; background:linear-gradient(to bottom, #123, #fff);">-->


    <!--    <div class="container-fluid px-0" style="background:linear-gradient(to top, #151515, #cf342b)">-->
<!--        <button class="btn float-start" style="line-height: .8; padding:5px;" data-bs-toggle="offcanvas" data-bs-target="#offcanvas" role="button">-->
<!--            <p style="color:#ffffff; margin-top:3rem; font-weight: bold;">Menu</p>-->
<!--&lt;!&ndash;            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right-square-fill" viewBox="0 0 16 16">&ndash;&gt;-->
<!--&lt;!&ndash;                <path d="M0 14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v12zm4.5-6.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5a.5.5 0 0 1 0-1z"/>&ndash;&gt;-->
<!--&lt;!&ndash;            </svg>&ndash;&gt;-->
<!--&lt;!&ndash;            <i class="bi bi-arrow-right-square-fill fs-3" data-bs-toggle="offcanvas" data-bs-target="#offcanvas"></i>&ndash;&gt;-->
<!--           <div style="display:inline-block;">-->
<!--               <svg style="background-color: #ffffff;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right-square" viewBox="0 0 16 16">-->
<!--                   <path fill-rule="evenodd" d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm4.5 5.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/>-->
<!--               </svg>-->
<!--               <i class="bi bi-arrow-right-square"></i>-->
<!--           </div>-->
<!--        </button>-->
        <div class="container-fluid px-0" style="background:linear-gradient(to bottom, #000000, #8d1c15)">

        <button class="btn float-start" style="line-height: .8; padding:5px;" data-bs-toggle="offcanvas" data-bs-target="#offcanvas" role="button">
            <img th:src="@{/images/logo_only.png}" style="width: 55px;height: 55px;margin-top:2rem;" alt="">
            <p style="color:#ffffff; margin-top:1rem; font-weight: bold; font-size: 1.2rem">Menu</p>
            <div style="display:inline-block;">
                <svg style="background-color: #ffffff;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right-square" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm4.5 5.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/>
                </svg>
                <i class="bi bi-arrow-right-square"></i>
            </div>
        </button>
        <div class="row g-0 vh-100">
            <!-- First column -->
            <div class="col-lg-6 h-100" style="position:relative; text-align: center; background-color: #350909; padding: 0px 2px">

                <!-- from: https://codepen.io/lukezak/pen/rVZMgv (full screen toggle) -->
                <div class="container panel-vm panel-default h-100" style="text-align: center; background-color: #030303;">
                    <div class="panel-heading" style="position: relative">
                        <div class="align-right upwards-2r" style="margin-top: 0 !important; position: relative; top:1rem; right: 1rem;">
                            <a href="#" id="vm-fullscreen" role="button" title="Toggle fullscreen">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-angle-expand svg-expand" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707z"/>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-angle-contract svg-contract no_display" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M.172 15.828a.5.5 0 0 0 .707 0l4.096-4.096V14.5a.5.5 0 1 0 1 0v-3.975a.5.5 0 0 0-.5-.5H1.5a.5.5 0 0 0 0 1h2.768L.172 15.121a.5.5 0 0 0 0 .707zM15.828.172a.5.5 0 0 0-.707 0l-4.096 4.096V1.5a.5.5 0 1 0-1 0v3.975a.5.5 0 0 0 .5.5H14.5a.5.5 0 0 0 0-1h-2.768L15.828.879a.5.5 0 0 0 0-.707z"/>
                                </svg>
                                <i id="VMFullScreenTogler" class="bi bi-arrows-angle-expand"></i>
                            </a>
                        </div>
                        <ul class="list-inline panel-actions" style="margin: 0 !important;">
<!--                            <li style="padding-top:1.7rem; padding-bottom: 0.5rem; margin-bottom: 0">-->
                            <li style="color:#d1c6c6;">
                                <h2 class="panel-title" style="display: inline-block;padding-top:1.7rem; padding-bottom: 0.5rem; margin-bottom: 0">Virtual Machine</h2>
                                <a style="display: inline; position: relative;bottom:0.3rem" href="#" class="nav-link dropdown-toggle text-truncate gear-icon" id="dropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="white" class="bi bi-gear" viewBox="0 0 16 16">
                                        <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
                                        <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
                                    </svg>
                                    <i class="bi bi-gear"></i>
                                </a>
                                <ul class="dropdown-menu text-small vm-conf-menu" aria-labelledby="dropdown">
                                    <li>
                                        <a class="dropdown-item power-on" href="#">Power On</a>
                                    </li>
                                    <li>
                                        <a class="dropdown-item power-off" href="#" >Power Off</a>
                                    </li>

                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div class="panel-body" style="height: 80vh;max-height: 80vh;">
                        <div id="wmksContainer" style="height: 80vh;max-height: 80vh;" class="vm-powered-on"></div>
                        <div class="vm-powered-off no_display" style="height: 80vh;max-height: 80vh; background-color: white; color:black; display: grid;justify-content: center; align-items: center; font-size: 2rem">
                            <div>
                                <p>VM is powered off.</p>
                                <p>To view - turn power on
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="black" class="bi bi-gear" viewBox="0 0 16 16">
                                        <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
                                        <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
                                    </svg>
                                    <i class="bi bi-gear"></i>.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>


            <!-- Second column -->
            <div class="col-lg-6 h-100 " style="text-align: center;  background-color: #350909; padding: 0px 5px">

                <!-- from: https://codepen.io/lukezak/pen/rVZMgv (full screen toggle) -->
                <div class="container panel-lab panel-default h-100" style="background-color: #030303;">
                    <!--  toggle from https://getbootstrap.com/docs/5.1/forms/checks-radios/-->
                    <!-- Default switch -->
                    <div class="form-check form-switch" style="text-align: left; margin:1rem; margin-bottom: 0;line-height: 1.1rem;">
                        <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckChecked">
                        <label class="form-check-label" for="flexSwitchCheckChecked">Check to view Course Labs</label>
                        <div id="full-lab-section" class="align-right upwards-2r no_display" style="margin-top: 0 !important; position: relative; top: -1.5rem">
                            <a href="#" id="lab-fullscreen" role="button" title="Toggle fullscreen">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-angle-expand svg-expand" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707z"/>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-angle-contract svg-contract no_display" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M.172 15.828a.5.5 0 0 0 .707 0l4.096-4.096V14.5a.5.5 0 1 0 1 0v-3.975a.5.5 0 0 0-.5-.5H1.5a.5.5 0 0 0 0 1h2.768L.172 15.121a.5.5 0 0 0 0 .707zM15.828.172a.5.5 0 0 0-.707 0l-4.096 4.096V1.5a.5.5 0 1 0-1 0v3.975a.5.5 0 0 0 .5.5H14.5a.5.5 0 0 0 0-1h-2.768L15.828.879a.5.5 0 0 0 0-.707z"/>
                                </svg>
                                <i id="labFullScreenTogler" class="bi bi-arrows-angle-expand"></i>
                            </a>
                        </div>
                        <div id="full-stu-vm-section" class="align-right upwards-2r" style="margin-top: 0 !important; position: relative; top: -1.5rem">
                            <a href="#" id="vm-student-fullscreen" role="button" title="Toggle fullscreen">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-angle-expand svg-expand" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707z"/>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-angle-contract svg-contract no_display" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M.172 15.828a.5.5 0 0 0 .707 0l4.096-4.096V14.5a.5.5 0 1 0 1 0v-3.975a.5.5 0 0 0-.5-.5H1.5a.5.5 0 0 0 0 1h2.768L.172 15.121a.5.5 0 0 0 0 .707zM15.828.172a.5.5 0 0 0-.707 0l-4.096 4.096V1.5a.5.5 0 1 0-1 0v3.975a.5.5 0 0 0 .5.5H14.5a.5.5 0 0 0 0-1h-2.768L15.828.879a.5.5 0 0 0 0-.707z"/>
                                </svg>
                                <i id="studentsVmFullScreenTogler" class="bi bi-arrows-angle-expand"></i>
                            </a>
                        </div>
                    </div>
                    <div class="lab-section  no_display" style="color:#d1c6c6;">
                        <div class="panel-heading">

                            <ul class="list-inline panel-actions" style="margin: 0 !important;">
                                <h2 id="lab-header" style="margin-right: 1rem"></h2>
                            </ul>
                        </div>
                        <!-- Lab content -->
                        </hr>
                        <div id="lab-video-container" class="embed-responsive embed-responsive-16by9 no_display" style="width: 300px; margin: auto; margin-top:1rem;margin-bottom:1rem;">
                            <iframe id="lab-video" style="min-height: 0px; max-height: 300px; min-width:0px;  max-width: 300px; margin: auto; margin-top:1rem;margin-bottom:1rem;" class="embed-responsive-item" allowfullscreen></iframe>
                        </div>
                        <div id="lab-image-container" class="no_display"  style="width: 300px; margin: auto;">
                            <img id="lab-image" style="min-height: 0px; object-fit: contain; max-height: 300px;min-width:0px;max-width: 300px;"/>
                        </div>

                        <p id="lab-desc" style="font-size: 1.5rem; max-height:inherit;padding: 1rem;padding-left: 2rem; text-align: left"></p>

                    </div>

                    <div class="students-vms-section" style="height: 80vh;max-height: 80vh;color:#d1c6c6;">
                        <div class="panel-heading">

                            <ul class="list-inline panel-actions" style="margin: 0 !important;">
                                <li>
                                    <h2 id="vm-student-name-title" class="panel-title"></h2>
<!--                                    <h3  class="panel-title" style="height: 3rem !important; margin-bottom: 0"></h3>-->
                                </li>
                            </ul>
                        </div>
                        <!-- Student VM -->
                        <div id="wmksContainerStudent" style="height: 80vh;max-height: 80vh;"  class="student-vm-powered-on"></div>
                        <div class="student-vm-powered-off no_display" style="height: 80vh;max-height: 80vh; background-color: white; color:black; display: grid;justify-content: center; align-items: center; font-size: 2rem">
                            <div>
                                <p>Student VM is powered off.</p>
                                <p>Please contact student...</p>
                            </div>
                        </div>


                    </div>

                </div>


            </div>
        </div>
    </div>
</section>

<script type="text/javascript" th:inline="javascript">
    //model data from backend

    window.onload = (event) => {

        const courseList = [[${listCourse}]]
    const ticket = [[${ticket}]];
    let wmks;
    let wmksStudent;
    let firstConnectionOnLoad = true;
    // if no console ticket don't attemt to create the VM
    // if(ticket){
        //console VM
        wmks = WMKS.createWMKS("wmksContainer",{})
            .register(WMKS.CONST.Events.CONNECTION_STATE_CHANGE, function(event,data){
                if(data.state == WMKS.CONST.ConnectionState.CONNECTED){
                    console.log("Instructor VM connection state change : connected");
                    console.log('firstConnectionOnLoad');
                    console.log(firstConnectionOnLoad);
                    if(firstConnectionOnLoad){
                        console.log('!@#!@#!@#!@#!Yup It is true');
                        firstConnectionOnLoad = false;
                        console.log(firstConnectionOnLoad === true);
                        populateVMSectionWithActiveVM("student", false);
                    }}
            });

        // wmks.connect(ticket);
        // sleep(1250).then(() => {
        //     wmks.sendCAD();
        //     wmks.sendKeyCodes([27]) ;
        // });
        //student console
        wmksStudent = WMKS.createWMKS("wmksContainerStudent",{})
            .register(WMKS.CONST.Events.CONNECTION_STATE_CHANGE, function(event,data){
                if(data.state == WMKS.CONST.ConnectionState.CONNECTED){
                    console.log("Student VM connection state change : connected");
                }
            });
        // wmksStudent.connect(ticket);
        // sleep(1250).then(() => {
        //     wmksStudent.sendCAD();
        //      wmksStudent.sendKeyCodes([27]) ;

        // });
    // }

        // if VM is displayed
        const webmks = document.querySelector('#mainCanvas');
        const webmksStudent = document.querySelectorAll('#mainCanvas').item(1);

        setCanvasAttributes(webmks);
        setCanvasAttributes(webmksStudent);
        // if(ticket) {
            //position vm properly inside div
            // webmks.setAttribute('style', 'position:relative !important');
            // webmks.setAttribute('style', 'display:inline-block !important');
            // webmks.setAttribute('style', 'padding:0px !important');
            // webmks.setAttribute('style', 'margin:0px !important');
            // // webmks.setAttribute('style', 'transform:null !important');
            // webmks.setAttribute('style', 'width:null !important')
            // webmks.setAttribute('style', 'height:null !important')
            // webmks.setAttribute('style', 'top:null')
            // webmks.setAttribute('style', 'left:null')
            // webmks.setAttribute('style', 'position:null')
            // webmks.setAttribute('style', 'min-height:80vh !important');
            // webmks.setAttribute('style', 'max-height:80vh !important');
            // webmks.setAttribute('style', 'height:80vh !important');
            // // webmks.setAttribute('style', 'scale:null !important');
            //
            // webmksStudent.setAttribute('style', 'position:relative !important');
            // webmksStudent.setAttribute('style', 'display:inline-block !important');
            // webmksStudent.setAttribute('style', 'padding:0px !important');
            // webmksStudent.setAttribute('style', 'margin:0px !important');
            // // webmks.setAttribute('style', 'transform:null !important');
            // webmksStudent.setAttribute('style', 'width:null !important')
            // webmksStudent.setAttribute('style', 'height:null !important')
            // webmksStudent.setAttribute('style', 'top:null')
            // webmksStudent.setAttribute('style', 'left:null')
            // webmksStudent.setAttribute('style', 'position:null')
            // webmksStudent.setAttribute('style', 'max-height:80vh !important');
            // webmksStudent.setAttribute('style', 'min-height:80vh !important');
            // webmksStudent.setAttribute('style', 'height:80vh !important');
            // webmksStudent.setAttribute('style', 'scale:null !important');

        // }

        console.log([[${listCourse}]]);

        // menus
        const cMenu = document.querySelector(".courses-menu");
        const labsMenuSection = document.querySelector(".labs-menu-section");
        const lMenu = document.querySelector(".labs-menu");
        const vmInsMenu = document.querySelector(".vm-instructor-menu");
        const studentsVMsMenuSection = document.querySelector(".students-vms-menu-section");
        const vmStuMenu = document.querySelector(".all-students-vms-menu");
        // lab elements
        const labSection = document.querySelector(".lab-section");
        const studentsVmsSection = document.querySelector(".students-vms-section");
        const labHeader = document.querySelector("#lab-header");
        const labVideo = document.querySelector("#lab-video");
        const labImgContainer = document.querySelector("#lab-image-container");
        const labVideoContainer = document.querySelector("#lab-video-container");
        const labImg = document.querySelector("#lab-image");
        const labDesc = document.querySelector("#lab-desc");

        const vmDisplayed = document.querySelector(".vm-powered-on");
        const vmNotDisplayed = document.querySelector(".vm-powered-off");
        const studentVmDisplayed = document.querySelector(".student-vm-powered-on");
        const studentVmNotDisplayed = document.querySelector(".student-vm-powered-off");

        const userIconForStudentVmsMenu =  document.querySelector("#userIconForStudentVmsMenu");


        let vmPowerOn = document.querySelector(".power-on");
        let vmPowerOff = document.querySelector(".power-off");

        //set first element of each menu as active (when page first loads)
        let activeClassElement = cMenu.firstElementChild.querySelector("a");
        let activeLabElement = lMenu.firstElementChild.querySelector("a");
        let activeInstructorVMElement = vmInsMenu.firstElementChild.querySelector("a");

        let activeStudentVMElement = vmStuMenu.querySelector("li").querySelector("ul").querySelector("a");
        activeClassElement.classList.add("active");
        activeLabElement.classList.add("active");
        activeInstructorVMElement.classList.add("active");
        activeStudentVMElement.classList.add("active");

        //populate lab section with active lab data
        let instructorId = [[${user.id}]]
        let instructorVmsJS = courseList[0]["publicVms"].filter(vm => vm.instructorId == instructorId);
        // let allStudentsVmsJS = courseList[0]["publicStudentVmsMap"];
        let allStudentsVmsJS =[];
        let activeStudentsVmsJS;
        for (const stu in courseList[0]["publicStudentVmsMap"]) {
            activeStudentsVmsJS = courseList[0]["publicStudentVmsMap"][stu][0];
            console.log('activeStudentsVmsJS');
            console.log(activeStudentsVmsJS);
            break;
        }

        courseList.forEach(c =>{
            console.log('Adding course');
            console.log(c);
            console.log(c["publicStudentVmsMap"]);

            for (const stu in c["publicStudentVmsMap"]) {
                console.log('inside!!!');
                console.log(stu);
                console.log(c["publicStudentVmsMap"][stu]);
                allStudentsVmsJS.push(c["publicStudentVmsMap"][stu][0]);
            }
        });
        console.log('allStudentsVmsJS after adding');
        console.log(allStudentsVmsJS);
        console.log('activeStudentsVmsJS');
        console.log(activeStudentsVmsJS);

        let activeCourseJS = courseList[0];
        let activeLabJS = courseList[0]["publicLabs"][0];
        let activeInstructorVmJS = instructorVmsJS[0];

        // let activeStudentVmJS = Object.entries(allStudentsVmsJS)[0];
        // console.log( Object.entries(allStudentsVmsJS));
        // console.log( Object.entries(allStudentsVmsJS)[0]);
        // console.log( Object.entries(allStudentsVmsJS)[0][1]);
        // console.log( Object.entries(allStudentsVmsJS)[0][1][0]);

        let activeStudentVmJS = allStudentsVmsJS[0];
        console.log(activeStudentVmJS);


        labHeader.textContent = 'Lab ' + activeLabJS["number"] + ': '  + activeLabJS["title"];
        labDesc.textContent = activeLabJS["description"];
        // TODO bring this back...
        if(activeLabJS["image"])  {
            labImg.setAttribute('src', activeLabJS["image"]);
            labImgContainer.classList.remove('no_display')
        }
        if(activeLabJS["link"])  {
            labVideo.setAttribute('src', activeLabJS["link"]);
            labVideoContainer.classList.remove('no_display')
        }

        //Add Toggle VM fullscreen functionality
        const VMToggleFullScreen = document.querySelector("#vm-fullscreen");
        const VMPanel = document.querySelector(".panel-vm");
        const VMsvgEx = VMPanel.querySelector(".svg-expand");
        const VMsvgCon = VMPanel.querySelector(".svg-contract");
        const VMI = document.querySelector("#VMFullScreenTogler");
        // const topNavBar = document.querySelector(".sticky-top");
        // let firstConnectionOnLoad = true;
        VMToggleFullScreen.addEventListener('click', (e) => {
            e.preventDefault();
            // VMsvgEx.classList.toggle('no_display');
            // VMsvgCon.classList.toggle('no_display');
            // VMI.classList.toggle('bi-arrows-angle-expand');
            // VMI.classList.toggle('bi-arrows-angle-contract');
            // VMPanel.classList.toggle('panel-fullscreen');
            // VMPanel.classList.toggle('pdg-top-70');
            // topNavBar.classList.toggle('no_display');
            // populateVMSectionWithActiveVM("instructor",false);
            wmks = WMKS.createWMKS("wmksContainer",{})
                .register(WMKS.CONST.Events.CONNECTION_STATE_CHANGE, function(event,data){
                    if(data.state == WMKS.CONST.ConnectionState.CONNECTED){
                        console.log("Instructor VM connection state change : connected");
                    }
                });
            wmks.enterFullScreen();
        });

        const VMStudentToggleFullScreen = document.querySelector("#vm-student-fullscreen");
        // let firstConnectionOnLoad = true;
        VMStudentToggleFullScreen.addEventListener('click', (e) => {
            e.preventDefault();
            // populateVMSectionWithActiveVM("instructor",false);
            wmksStudent = WMKS.createWMKS("wmksContainerStudent",{})
                .register(WMKS.CONST.Events.CONNECTION_STATE_CHANGE, function(event,data){
                    if(data.state == WMKS.CONST.ConnectionState.CONNECTED){
                        console.log("Instructor VM connection state change : connected");}
                    // if(firstConnectionOnLoad === true){
                    //     console.log('!@#!@#!@#!@#!Yup It is true');
                    //     firstConnectionOnLoad = false;
                    //     console.log(firstConnectionOnLoad === true);
                    //     populateVMSectionWithActiveVM("student", false);
                    //
                    // }
                });
            wmksStudent.enterFullScreen();
            sleep(1250).then(() => {
                wmksStudent.sendCAD();
                wmksStudent.sendKeyCodes([27]) ;

            });
        });

        //Add Toggle Lab fullscreen functionality
        const labToggleFullScreen = document.querySelector("#lab-fullscreen");
        const labPanel = document.querySelector(".panel-lab");
        const labSvgEx = labPanel.querySelector(".svg-expand");
        const labSvgCon = labPanel.querySelector(".svg-contract");
        const labI = document.querySelector("#labFullScreenTogler");

        labToggleFullScreen.addEventListener('click', (e) => {
            e.preventDefault();
            labSvgEx.classList.toggle('no_display');
            labSvgCon.classList.toggle('no_display');
            labI.classList.toggle('bi-arrows-angle-expand');
            labI.classList.toggle('bi-arrows-angle-contract');
            labPanel.classList.toggle('panel-fullscreen');
            // labPanel.classList.toggle('pdg-top-70');
            // topNavBar.classList.toggle('no_display');
        });

        // add click event for course menu items and logic to repopulate the other menus
        const populateLabMenuActiveCourse = () => {
            let count = 1;
            // removing current lab menu elements. Source: from: https://stackoverflow.com/questions/3955229/remove-all-child-elements-of-a-dom-node-in-javascript
            while (lMenu.lastChild) {
                lMenu.removeChild(lMenu.lastChild);
            }

            activeCourseJS.publicLabs.forEach( lab => {
                const liElement = document.createElement("li");
                const aElement = document.createElement("a");
                aElement.classList.add("dropdown-item");
                aElement.classList.add(lab.id);
                aElement.textContent = lab.number + '-' +lab.title;
                if(count <= 1) {
                    aElement.classList.add('active');
                    activeLabElement = aElement;
                    let courseId = Array.from(activeClassElement.classList).filter(className => !isNaN(className))[0];
                    activeLabJS = activeCourseJS.publicLabs.filter(labJS => labJS.id == lab.id)[0];
                    count++;
                }
                liElement.append(aElement);
                lMenu.append(liElement);
            });
        };

        const populateVmMenusActiveCourse = () => {
            let itemInInstructorVmMenu = 1;
            // removing current VM menu elements. Source: from: https://stackoverflow.com/questions/3955229/remove-all-child-elements-of-a-dom-node-in-javascript
            while (vmInsMenu.lastChild) {
                vmInsMenu.removeChild(vmInsMenu.lastChild);
            }

            activeCourseJS.publicVms.forEach( vm => {
                const liElement = document.createElement("li");
                const aElement = document.createElement("a");
                aElement.classList.add("dropdown-item");
                aElement.classList.add(vm.vmID);
                aElement.textContent = vm.name;
                liElement.append(aElement);
                if(itemInInstructorVmMenu <= 1 && vm.instructorId == instructorId) {
                    aElement.classList.add('active');
                    activeInstructorVMElement = aElement;
                    itemInInstructorVmMenu++;
                    activeInstructorVmJS = activeCourseJS.publicVms.filter(vmJS => vmJS.instructorId == instructorId).filter(vmJS => vmJS.vmID == vm.vmID)[0];
                }

                if(vm.instructorId == instructorId) vmInsMenu.append(liElement);
            });
        };





        const populateStudentsVmMenusActiveCourse = () => {
            let itemInStudentVmsMenu = 1;
            // removing current VM menu elements. Source: from: https://stackoverflow.com/questions/3955229/remove-all-child-elements-of-a-dom-node-in-javascript
            const ULs =   vmStuMenu.querySelectorAll('ul');
            console.log('!!!!!!!!!!!!!Student Menu!!!!!!!!!!!!!!!!!!!!!');
            console.log(vmStuMenu);
            console.log('ULs');
            console.log(ULs);


            while (vmStuMenu.lastChild) {
                vmStuMenu.removeChild(vmStuMenu.lastChild);
            }

            console.log('activeCourseJS');
            console.log(activeCourseJS);


            // ULs.forEach(function (currentValue, currentIndex, listObj) {
            //     console.log('before while loop')
            //     console.log(currentValue)
            //     while (currentValue.lastChild) {
            //         console.log('inside while loop')
            //         console.log('currentValue.lastChild');
            //         console.log(currentValue.lastChild);
            //         currentValue.removeChild(currentValue.lastChild);
            //     }
            //     console.log('after while loop')
            //     console.log(currentValue)
            //     vmStuMenu.removeChild(currentValue);
            // }, "myThisArg");






            // <li th:each="studentVmsMap : ${listCourse[0].publicStudentVmsMap}">
            //     <div style="pointer-events: none;">
            //         <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="black"
            //              className="bi bi-person-circle" viewBox="0 0 16 16">
            //             <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
            //             <path fill-rule="evenodd"
            //                   d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
            //         </svg>
            //         <i className="bi bi-person-circle"></i>
            //         <span style="color:black;" className="ms-1 d-none d-sm-inline"
            //               th:text="${studentVmsMap.key.username}"}>
            //     </span>
            // </div>
            // <!--                        <ul class="dropdown-menu text-small shadow vm-students-menu" aria-labelledby="dropdown">-->
            // <ul className="a-student-vms-menu" style="list-style-type: none;">
            //     <li th:each="vm : ${studentVmsMap.value}">
            //         <a className="dropdown-item" href="#" th:classappend="${vm.vmID}" th:text="${vm.name}"></a>
            //     </li>
            // </ul>
            // </li>




            // activeCourseJS.publicStudentVmsMap.forEach((valueVmList, keyStudent) => {
            for (const stu in activeCourseJS['publicStudentVmsMap']) {
                const topLiElement = document.createElement("li");
                const divStudentIconForAndName = userIconForStudentVmsMenu.content.cloneNode(true);
                const span = divStudentIconForAndName.querySelector('span');
                let start = stu.lastIndexOf(" ");
                start++;
                span.textContent = stu.substring(start);
                const ulElement = document.createElement("ul");
                ulElement.classList.add('a-student-vms-menu');
                ulElement.classList.add('hover-pointer');
                ulElement.setAttribute('style', 'list-style-type: none;pointer-events: auto;')
                const liElement = document.createElement("li");
                console.log('===stu===');
                console.log(stu);
                console.log(stu.substring(start));

                topLiElement.append(divStudentIconForAndName);

                activeCourseJS['publicStudentVmsMap'][stu].forEach( vm => {
                    console.log("{Ha????");
                    console.log(vm);

                    const aElement = document.createElement("a");
                    aElement.classList.add("dropdown-item");
                    aElement.classList.add(vm.vmID);
                    aElement.textContent = vm.name;
                    liElement.append(aElement);
                    if(itemInStudentVmsMenu <= 1) {
                        aElement.classList.add('active');
                        activeInstructorVMElement = aElement;
                        itemInStudentVmsMenu++;
                        // activeInstructorVmJS = activeCourseJS.publicVms.filter(vmJS => vmJS.instructorId == instructorId).filter(vmJS => vmJS.vmID == vm.vmID)[0];
                        console.log("{{{{{{activeStudentVmJS}}}}}}");
                        console.log('before');
                        console.log('activeStudentVmJS');
                        console.log(activeStudentVmJS);
                        console.log('allStudentsVmsJS');
                        console.log(allStudentsVmsJS);
                        // let selectedStudent = new Map([...allStudentsVmsJS].filter(([student, vmList])=>student.username ===vm.username))[0].key();
                        // activeStudentVmJS = allStudentsVmsJS[stu].filter(studentVm => studentVm.vmID == vm.vmID)[0];

                        activeStudentVmJS = vm;

                        // for (const stu in allStudentsVmsJS) {
                        //     let studentVms = allStudentsVmsJS[stu];
                        //     if(studentVms.find(vm => vm.vmID === );){}
                        //
                        //     activeStudentsVmsJS = allStudentsVmsJS[stu];
                        //     console.log('activeStudentsVmsJS');
                        //     console.log(activeStudentsVmsJS);
                        //     break;
                        // }

                        console.log('before');
                        console.log('activeStudentVmJS');
                        console.log(activeStudentVmJS);
                        console.log('allStudentsVmsJS');
                        console.log(allStudentsVmsJS);
                        // console.log('selected student');
                        // console.log(selectedStudent);
                        console.log("{{{{{{activeStudentVmJS}}}}}}");

                    }
                    ulElement.append(liElement);

                });
                topLiElement.append(ulElement);
                vmStuMenu.append(topLiElement);

            };
        };









        const populateOtherMenusWithActiveCourse = () => {
            populateLabMenuActiveCourse();
            populateVmMenusActiveCourse();
            populateStudentsVmMenusActiveCourse();
            addEventListenerToMenuItems(lMenu,'Labs');
            addEventListenerToMenuItems(vmInsMenu,'VMs');
            addEventListenerToMenuItems(vmStuMenu,'StudentsVMs');
            populateLabSectionWithActiveLab();
            populateVMSectionWithActiveVM("instructor", false);
            sleep(1250).then(() => {
                populateVMSectionWithActiveVM("student", false);
            });
            //from https://stackoverflow.com/questions/951021/what-is-the-javascript-version-of-sleep
            // sleep time expects milliseconds
            // function sleep (time) {
            //     return new Promise((resolve) => setTimeout(resolve, time));
            // }
            //
            // // Usage!
            // sleep(250).then(() => {
            //     populateVMSectionWithActiveVM("student", false);
            // });

        };

        function addEventListenerToMenuItems(menu, typeOfMenu){
            let aElements = menu.querySelectorAll('a');
            // aElements[0].classList.add('active');

            if(typeOfMenu == 'Courses') {
                aElements.forEach( aElement => {
                    aElement.addEventListener('click', (e) => {
                        e.preventDefault();
                        if(activeClassElement){
                            activeClassElement.classList.remove('active');
                        }
                        activeClassElement = e.target;
                        activeClassElement.classList.add('active');
                        let courseId = Array.from(activeClassElement.classList).filter(className => !isNaN(className))[0];
                        activeCourseJS = courseList.filter(course => course.id == courseId)[0];
                        populateOtherMenusWithActiveCourse();
                    });
                });
            } else if(typeOfMenu == 'Labs') {
                aElements.forEach(aElement => {
                    aElement.addEventListener('click', (e) => {
                        e.preventDefault();
                        if (activeLabElement) {
                            activeLabElement.classList.remove('active');
                        }
                        activeLabElement = e.target;
                        activeLabElement.classList.add('active');
                        let labId = Array.from(activeLabElement.classList).filter(className => !isNaN(className))[0];
                        activeLabJS = activeCourseJS.publicLabs.filter(lab => lab.id == labId)[0];
                        populateLabSectionWithActiveLab();
                    });
                });
            }  else if(typeOfMenu == 'VMs') {
                aElements.forEach(aElement => {
                    aElement.addEventListener('click', (e) => {
                        e.preventDefault();
                        if(activeInstructorVMElement){
                            activeInstructorVMElement.classList.remove('active');
                        }
                        activeInstructorVMElement = e.target;
                        activeInstructorVMElement.classList.add('active');
                        let vmId = Array.from(activeInstructorVMElement.classList).filter(className => !isNaN(className))[0];
                        activeInstructorVmJS = activeCourseJS.publicVms.filter(vm => vm.instructorId == instructorId).filter(vm => vm.vmID == vmId)[0];

                        populateVMSectionWithActiveVM("instructor", false);
                    });
                });
            }

            else if(typeOfMenu == 'StudentsVMs') {
                let ulElements = menu.querySelectorAll('ul');
                console.log('StudentsVMs Eevent Listeners!@!#!@#!@#!@#!@#!@#!@#!@#!@#!@#!@#!@#!@#');
                console.log('StudentsVMs menu Element');
                console.log(menu);

                ulElements.forEach(ulElement => {
                    aElements = ulElement.querySelectorAll('a');
                    console.log('Adding a Student Menu !@!#!@#!@#!@#!@#!@#!@#!@#!@#!@#!@#!@#!@#');

                    aElements.forEach(aElement => {
                        console.log('Adding VM link !@!#!@#!@#!@#!@#!@#!@#!@#!@#!@#!@#!@#!@#');

                        aElement.addEventListener('click', (e) => {
                            e.preventDefault();
                            if(activeStudentVMElement){
                                console.log('activeStudentVMElement');
                                console.log(activeStudentVMElement);
                                activeStudentVMElement.classList.remove('active');
                            }
                            activeStudentVMElement = e.target;
                            activeStudentVMElement.classList.add('active');

                            let vmId = Array.from(activeStudentVMElement.classList).filter(className => !isNaN(className))[0];

                            // activeStudentVmJS = activeCourseJS.publicVms.filter(vm => vm.instructorId != instructorId).filter(vm => vm.vmID == vmId)[0];
                            // let selectedStudent = new Map([...activeCourseJS['publicStudentVmsMap']].filter(([student, vmList])=>student.username ===vm.username))[0];
                            activeStudentVmJS = allStudentsVmsJS.filter(studentVm => studentVm.vmID == vmId)[0];

                            console.log('inside vevent Listener!@!#!@#!@#!@#!@#!@#!@#!@#!@#!@#!@#!@#!@#');
                            console.log('activeStudentVMElement');
                            console.log('allStudentsVmsJS');
                            console.log(allStudentsVmsJS);
                            console.log('activeStudentVmJS');
                            console.log(activeStudentVmJS);
                            console.log('vmStuMenu');
                            console.log(vmStuMenu);
                            console.log('vmid');
                            console.log(vmId);

                            // TODO populate studentVm Section
                            populateVMSectionWithActiveVM("student", false);
                        });
                    });
                });

            }
        }

        function populateLabSectionWithActiveLab(){
            labHeader.textContent = 'Lab ' + activeLabJS["number"] + ': '  + activeLabJS["title"];
            labDesc.textContent = activeLabJS["description"];
            console.log(activeLabJS);
            if(activeLabJS["image"]){
                labImg.setAttribute('src', activeLabJS["image"]);
                labImgContainer.classList.remove("no_display");
            } else{
                labImgContainer.classList.add("no_display");
            }
            if(activeLabJS["link"]){
                labVideo.setAttribute('src', activeLabJS["link"]);
                labVideoContainer.classList.remove("no_display");
            }else{
                labVideoContainer.classList.add("no_display");
            }
        }

        const newCanvases = document.querySelectorAll('#mainCanvas');


        function populateVMSectionWithActiveVM(vmType, callBoth){
            //source,fetch call: https://www.geeksforgeeks.org/how-to-make-ajax-call-from-javascript/
            let url = "";
            let vmContainer;
            if(vmType == 'instructor'){
                url = 'http://localhost:8080/console-ticket/instructor/na/'+activeCourseJS.id+'/' +activeInstructorVmJS.vmID ;
                // console.log("reload instructor");
                // console.log(url);
                vmContainer = wmks;
            }
            else{
                let studentTitle = document.querySelector("#vm-student-name-title");
                studentTitle.textContent = 'Student VM (' + activeStudentVmJS.email + ', ' + activeStudentVmJS.username+')' ;
                // console.log('??????????');
                // console.log(activeStudentVmJS);
                // console.log('??????????');
                url = 'http://localhost:8080/console-ticket/students/'+activeStudentVmJS.email+'/' +activeCourseJS.id+'/' +activeStudentVmJS.vmID ;
                vmContainer = wmksStudent;
                // console.log("reload student");
                // console.log(url);
            }
            // console.log('2 canvases')
            // console.log(newCanvases)
            setCanvasAttributes(newCanvases.item(0));
            setCanvasAttributes(newCanvases.item(1));

            // console.log('++++');
            console.log(url);
            // console.log('++++');
            // Making our request
            fetch(url,{ method: 'POST' })
                .then(Result => Result.json())
                .then(res => {
                    console.log('01010101101010101010010110101010101001');
                    console.log(res);
                    console.log(res.powerState);
                    console.log(res.powerState == 'on');

                    if(res.powerState == 'on'){
                        let newTicket = "wss://"+res.ticket;
                        console.log(newTicket);
                        vmContainer.connect(newTicket);
                        sleep(1250).then(() => {
                            vmContainer.sendCAD();
                            vmContainer.sendKeyCodes([27]) ;
                        });
                    }


                    if(res.powerState == 'on' && vmType === 'instructor'){
                        vmDisplayed.classList.remove('no_display');
                        vmNotDisplayed.classList.add('no_display');
                    }else if(vmType === 'instructor'){
                        vmNotDisplayed.classList.remove('no_display');
                        vmDisplayed.classList.add('no_display');
                    } else if(res.powerState === 'on' && vmType === 'student'){
                        studentVmDisplayed.classList.remove('no_display');
                        studentVmNotDisplayed.classList.add('no_display');
                    } else if(vmType === 'student'){
                        studentVmNotDisplayed.classList.remove('no_display');
                        studentVmDisplayed.classList.add('no_display');

                    }

                    // if(callBoth){
                    //     populateVMSectionWithActiveVM("student", false)
                    // }
                    // vmContainer.updateScreen();

                    //from https://stackoverflow.com/questions/951021/what-is-the-javascript-version-of-sleep
                    // sleep time expects milliseconds
                    // Usage!

                })
                .catch(errorMsg => { console.log(errorMsg); });
        }
        populateVMSectionWithActiveVM("instructor", false);

        addEventListenerToMenuItems(cMenu,'Courses');
        addEventListenerToMenuItems(lMenu,'Labs');
        addEventListenerToMenuItems(vmInsMenu,'VMs');
        addEventListenerToMenuItems(vmStuMenu,'StudentsVMs');

        const toggleLabel = document.querySelector(".form-check-label");
        const toggleLabsVsStudentVms = document.querySelector(".form-check-input");

        toggleLabsVsStudentVms.addEventListener('click', (e) => {
            labsMenuSection.classList.toggle("no_display");
            labSection.classList.toggle("no_display");
            studentsVMsMenuSection.classList.toggle("no_display");
            // studentsVmsSection.classList.toggle("no_display");

            studentsVmsSection.classList.toggle("no_display");

            document.querySelector("#full-lab-section").classList.toggle("no_display");
            document.querySelector("#full-stu-vm-section").classList.toggle("no_display");

            if(labSection.classList.contains("no_display")){
                toggleLabel.textContent = "Check to view Course Labs";
                setCanvasAttributes(newCanvases.item(1));
                // webmksStudent.updateScreen()
            } else{
                toggleLabel.textContent = "Uncheck to view Students VMs";
            }
        });

        // populateVMSectionWithActiveVM("student", false);
        webmksStudent.setAttribute('style', 'height:80vh !important');
        webmksStudent.setAttribute('style', 'scale: none !important');


        console.log('111111111 vmStuMenu');
        console.log(vmStuMenu);




        vmPowerOn.addEventListener('click', (e) => {
            let url = "";
            let vmContainer;
            url = 'http://localhost:8080/powerOnTheVM/'+activeInstructorVmJS.vmID ;

            fetch(url,{ method: 'POST' })
                .then(Result => Result.json())
                .then(res => {
                    // let newTicket = "wss://"+ticket.ticket;
                    console.log(res);
                    populateVMSectionWithActiveVM("instructor", false);

                })
                .catch(errorMsg => { console.log(errorMsg); });
        });

        vmPowerOff.addEventListener('click', (e) => {
            let url = "";
            let vmContainer;
            url = 'http://localhost:8080/powerOffTheVM/' + activeInstructorVmJS.vmID ;

            fetch(url,{ method: 'POST' })
                .then(Result => Result.json())
                .then(res => {
                    console.log(res);
                    populateVMSectionWithActiveVM("instructor", false);

                })
                .catch(errorMsg => { console.log(errorMsg); });
        });

        // sleep(2500).then(() => {
        //     populateVMSectionWithActiveVM("student", false);
        // });
        //
        // $( wmks ).on( "connectionstatechange", function() {
        //     console.log( "<p> was clicked" );
        // });
    };


    function setCanvasAttributes(element){
        // console.log(element);
        element.setAttribute('style', 'position:absolute !important');
        element.setAttribute('style', 'display:inline-block !important');
        element.setAttribute('style', 'padding:0px !important');
        element.setAttribute('style', 'margin:0px !important');
        // webmks.setAttribute('style', 'transform:null !important');
        element.setAttribute('style', 'width:null !important')
        element.setAttribute('style', 'height:null !important')
        element.setAttribute('style', 'top:null')
        element.setAttribute('style', 'left:null')
        element.setAttribute('style', 'position:null')
        element.setAttribute('style', 'max-height:80vh !important');
        element.setAttribute('style', 'min-height:80vh !important');
        element.setAttribute('style', 'height:80vh !important');
    }

    function sleep (time) {
        return new Promise((resolve) => setTimeout(resolve, time));
    }

</script>


</body>
</html>